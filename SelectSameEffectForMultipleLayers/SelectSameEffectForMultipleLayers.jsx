// Selects same effect on multiple layers//// Francisco Zamorano, 2018var project = app.project;var selComp = project.activeItem;// runSelectSource();// runSelectSource =function(){if(app.project && app.project.activeItem && app.project.activeItem instanceof CompItem && app.project.activeItem.selectedLayers.length>0){	var project= app.project;	var selComp = project.activeItem; //get the active comp        var selLayer = selComp.selectedLayers[0];  var selEffect = selLayer.selectedProperties[0];  var numParameters = selEffect.numProperties;  //make sure we clear variables every time before assigning values  var selEffectName = null;  var selEffectValue = null;  var selEffectIndex = null;  //Get the selected property and parameter  //for each selected property, check if any of its parameters is selected =true  //if so, copy name of Effect, name of Parameter and its value and save them for later  for (var i = 1; i < numParameters +1; i++) {    if(selEffect.property(i).selected == true){      selEffectName = selEffect.name;      selEffectValue = selEffect.property(i).value;      selParameterName = selEffect.property(i).name;    }  }  alert ("You selected layer: " + selLayer.name + ", " + "property: " + selEffectName + ", " + selParameterName + "\n" + "Value of: " + selEffectValue + "\n" + "Will be copied to " + app.project.activeItem.selectedLayers.length + " layers");  //iterate through each selected layer  for(var i=0;i<app.project.activeItem.selectedLayers.length;i++){    $.writeln(" ----------------------------- ");      var nProps = selComp.selectedLayers[i].property("Effects").numProperties; //get number of effects for this layer      $.write("LAYER ");      $.writeln(selComp.selectedLayers[i].name);    for (var j=1; j < nProps+1; j++){            $.write("   " + selComp.selectedLayers[i].property("Effects").property(j).name);            var nParameters = selComp.selectedLayers[i].property("Effects").property(j).numProperties; //get number of parameters for each effect      $.writeln(", contains " + nParameters + " parameters");      //iterate through all the parameters on this effect      for (var k = 1; k < nParameters+1; k++){         $.write("       ");        $.write(selComp.selectedLayers[i].property("Effects").property(j).property(k).name);        $.writeln(" : " + selComp.selectedLayers[i].property("Effects").property(j).property(k).value);        //if name of the effect matches the original selection         if(selComp.selectedLayers[i].property("Effects").property(j).name == selEffectName){          //if name of the parameter matches the original selection           if(selComp.selectedLayers[i].property("Effects").property(j).property(k).name == selParameterName){            $.writeln(" <-- target");             selComp.selectedLayers[i].property("Effects").property(j).property(1).setValue(selEffectValue); // apply the value of original selection          }        }      }      $.writeln(" ---- ");    }    $.writeln(" ----------------------------- ");  }}else{	alert("Please select some layers first");}// };/*----------------------------------------------------------------------------------------------------------------------------*/function getIndexFromName(_name){    for(var i=1;i<project.items.length+1;i++){        var currComp = project.item(i);        if (currComp.name == _name){            //alert(currComp.name +" " + project.item(i).name + " " + i);            return i;        }    } }