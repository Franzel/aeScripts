/*This script copies the vertex positions of a mask and applies it to position on a different layerFrancisco ZamoranoJune 2015*/var project = app.project;//var myComp = project.item(getIndexfromName("Test1")); //change Comp's name herevar myComp = project.activeItem;var maskLayer = myComp.selectedLayers[0]; //change origin's layer name here// var targetLayer = myComp.layer("Head"); //zchange target's layer name herevar maskLayerName = maskLayer.name;var myMask = maskLayer.property("ADBE Mask Parade").property(1).maskShape; //get the maskvar myShape = myMask.value;var verts = myShape.vertices;var nVerts = verts.length;var bWorldCoords = true; //as default, bezier tangents positions are relative to the vertex, set this to true to get world coordinates instead// for(var i=0; i<nVerts; i++){// 	var xPos = verts[i][0];// 	var yPos = verts[i][1];//     $.writeln("vertex: " + i + "       X:" +  Math.round(xPos) + ",   Y:" + Math.round(yPos));// 	//targetLayer.position.setValueAtTime(i*1,[xPos,yPos]);// }var vertsSorted  = myShape.vertices.slice(0);var listX, listY = [];// vertsSorted.sort(compareVertices);for(var i=0; i<nVerts; i++){    var xPos = vertsSorted[i][0];    var yPos = vertsSorted[i][1];    listX[i] = xPos;    listY[i] = yPos;    $.writeln("vertex: " + i + "       X:" +  Math.round(xPos) + ",   Y:" + Math.round(yPos));    //targetLayer.position.setValueAtTime(i*1,[xPos,yPos]);}listX.sort(compareVertices);listY.sort(compareVertices);for(var i=0; i<nVerts; i++){    $.writeln("X_ " + i + ": " +  Math.round(listX[i]));}for(var i=0; i<nVerts; i++){    $.writeln("Y_ " + i + ": " +  Math.round(listY[i]));}myComp.layers.addSolid( [1,0,0], "ul", 10, 10, 1, myComp.duration );myComp.layer(1).position.setValue([listX[0], listY[0]]);myComp.layers.addSolid( [1,0,0], "ur", 10, 10, 1, myComp.duration );myComp.layer(1).position.setValue([listX[listX.length-1], listY[0]]);myComp.layers.addSolid( [1,0,0], "lr", 10, 10, 1, myComp.duration );myComp.layer(1).position.setValue([listX[listX.length-1], listY[listY.length-1]]);myComp.layers.addSolid( [1,0,0], "ll", 10, 10, 1, myComp.duration );myComp.layer(1).position.setValue([listX[0], listY[listY.length-1]]);myComp.layers.addSolid( [1,0,0], "ll", 10, 10, 1, myComp.duration );var minX = listX[0];var maxX = listX[listX.length-1];var minY = listY[0];var maxY = listY[listY.length-1];var cX = minX + (maxX-minX) / 2;var cY = minY + (maxY-minY) / 2;myComp.layers.addSolid( [1,0,0], "c", 10, 10, 1, myComp.duration );myComp.layer(1).position.setValue( [cX, cY] );repositionAnchor(maskLayer, cX, cY );/*----------------------------------------------------------------------------------------------------------------------------*/function getIndexfromName(_name){    for(var i=1;i<project.items.length+1;i++){        var currComp = project.item(i);        if (currComp.name == _name){            //alert(currComp.name +" " + project.item(i).name + " " + i);            return i;        }    } }compareVertices = function(a, b) {    return a > b;}/*----------------------------------------------------------------------------------------------------------------------------*/function repositionAnchor(_layer, _x, _y){     var thisLayer = _layer;     var thisLayerPos = thisLayer.property("Position").value;     var thisLayerW = thisLayer.width;     var thisLayerH = thisLayer.height;     var thisLayerAnchor = thisLayer.property("Anchor Point").value;     //reposition anchor     if(thisLayerAnchor[0] != 0){ //to make sure it does not happen more than once        thisLayer.property("Anchor Point").setValue([_x,_y]);        var newX = thisLayerPos[0] - _x;        var newY = thisLayerPos[1] - _y;        thisLayer.position.setValue([newX, newY]); //set new pos     }}